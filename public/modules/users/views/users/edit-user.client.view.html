<section data-ng-controller="UsersController" data-ng-init="findOne()">

    <h1>Edit user</h1>

    <div class="row">
        <form name="userForm" data-ng-submit="update()" novalidate>

            <md-text-float label="Username" ng-model="userToEdit.username" type="text" required></md-text-float>

            <div ng-show="userForm.username.$invalid" class="help-block">
                <p ng-show="userForm.username.$error.required" class="text-danger">Username is required</p>
            </div>

            <md-text-float label="FirstName" ng-model="userToEdit.firstName" type="text" required></md-text-float>
            <md-text-float label="LastName" ng-model="userToEdit.lastName" type="text" required></md-text-float>
            <md-text-float label="Email" ng-model="userToEdit.email" type="email" required></md-text-float>

            <label class="control-label col-sm-2">Role</label>
            <md-radio-group ng-model="userToEdit.role">
                <md-radio-button value="user">User</md-radio-button>
                <md-radio-button value="admin">Admin</md-radio-button>
            </md-radio-group>

            <div class="row">
                <div flex>Selected Groups</div>
                <div flex>Available Groups</div>
            </div>

            <div class="row">
                <div flex>
                    <md-checkbox ng-repeat="group in groupsSelected | orderBy:'title'"
                                 ng-click="removeGroup(group)" ng-checked="true"> {{group.title}}
                    </md-checkbox>
                </div>

                <div flex>
                    <md-checkbox ng-repeat="group in groups.all | orderBy:'title'"
                                 ng-click="addGroup(group)">{{group.title}}
                    </md-checkbox>
                </div>
            </div>

            <md-button type="submit" class="md-raised md-primary">
                <span ng-show="userToEdit._id"><i class="fa fa-save"></i> Update</span>
            </md-button>
            <div class="row md-warn" ng-show="error">
                <strong data-ng-bind="error"></strong>
            </div>
        </form>
    </div>
    <div class="row">
        <md-button ng-show="authentication.user.username===userToEdit.username" disabled="true"
                   class="md-accent md-warn" layout-align="center center">
            <i class="fa fa-trash-o"></i> You can't delete yourself.
        </md-button>
        <br>
        <md-button class="md-raised md-warn" ng-click="askDeleteUser=true"
                   ng-show="authentication.user.username!==userToEdit.username" ng-hide="askDeleteUser">
            <i class="fa fa-trash-o"></i> Delete User
        </md-button>

        <md-button ng-click="askDeleteUser=false" ng-show="askDeleteUser" class="md-raised md-warn">
            No, I don't want to delete this. <i class="fa fa-reply"></i>
        </md-button>
        <md-button data-ng-click="remove(userToEdit);" ng-show="askDeleteUser"
                   class="md-raised md-warn">
            Yes, I confirm <i class="fa fa-exclamation-triangle"></i>
        </md-button>
    </div>

</section>
