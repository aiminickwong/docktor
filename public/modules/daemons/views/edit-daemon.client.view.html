<section data-ng-controller="DaemonsController" data-ng-init="findOne()">

    <h1>
        <span ng-hide="daemon._id">Create Daemon</span>
        <span ng-show="daemon._id">Edit Daemon</span>
    </h1>

    <form name="daemonForm" novalidate>

        <div class="row">
            <md-text-float label="Name" ng-model="daemon.name" type="text" ng-pattern="patternTitle" required="true">
            </md-text-float>

            <div ng-show="daemonForm.name.$invalid" class="md-warn">
                The title have to match this pattern : [a-zA-Z0-9_]{1,200}
            </div>
        </div>

        <div class="row">
            <div flex="10">Site</div>

            <div flex>
                <select ng-model="daemon.selectSite"
                        ng-options="site as site.title for site in sites.all track by site._id">
                </select>
            </div>
        </div>

        <div class="row">
            <label>Docker Host</label>

            <div>
                <md-radio-group ng-model="daemon.protocol" required>
                    <md-radio-button value="http">http</md-radio-button>
                    <md-radio-button value="https">https</md-radio-button>
                </md-radio-group>
            </div>
            <div>
                <md-text-float label="IP or Hostname" ng-model="daemon.host" type="text" required="true">
                </md-text-float>
            </div>
            <div>
                <md-text-float label="Port" ng-model="daemon.port" type="number" required="true"></md-text-float>
            </div>
            <div>
                <md-text-float label="Timeout in ms" ng-model="daemon.timedout" type="number"
                               required="true"></md-text-float>
            </div>
        </div>
        <div class="row">

            <div flex="10">CA</div>

            <div flex>
                <md-input-group>
                <textarea name="ca" data-ng-model="daemon.ca" id="ca" class="form-control" cols="40" rows="3"
                          placeholder="CA Content File"></textarea>
                </md-input-group>
            </div>

        </div>
        <div class="row">
            <div flex="10">CERT</div>

            <div flex>
                <md-input-group>
                <textarea name="cert" data-ng-model="daemon.cert" id="cert" class="form-control" cols="40"
                          rows="3" placeholder="CERT Content File"></textarea>
                </md-input-group>
            </div>
        </div>
        <div class="row">
            <div flex="10">Key</div>

            <div flex>
                <md-input-group>
                <textarea name="key" data-ng-model="daemon.key" id="key" class="form-control" cols="40"
                          rows="3" placeholder="KEY Content File"></textarea>
                </md-input-group>
            </div>
        </div>
        <div class="row">
            <md-text-float class="long" label="Default data volume" ng-model="daemon.volume"
                           type="text"></md-text-float>

            <div>
                Example : /data
            </div>
        </div>
        <div class="row">
            <md-text-float class="long" label="URL cAdvisor Api" ng-model="daemon.cadvisorApi"
                           type="text"></md-text-float>

            <div>http://host:port/api/v1.0</div>
        </div>
        <div class="row">
            <md-text-float class="long" label="Description" ng-model="daemon.description" type="text"></md-text-float>
        </div>
    </form>

    <div class="row">
        <h3>Parameters</h3>

        <ul data-ng-repeat="parameter in daemon.parameters">
            <li>{{parameter.name}}:{{parameter.value}}
                <small><i>{{parameter.description}}</i></small>
                <a ng-click="askDeleteParameter=true" ng-hide="askDeleteParameter">
                    <i class="fa fa-lg fa-trash-o cursor-pointer" tooltip="Delete Parameter"
                       tooltip-popup-delay='750'></i>
                </a>
                <md-button ng-click="askDeleteParameter=false" ng-show="askDeleteParameter"
                           class="md-raised md-warn">
                    No, I don't want to delete this. <i class="fa fa-reply"></i>
                </md-button>
                <md-button data-ng-click="removeParameter(parameter);" ng-show="askDeleteParameter"
                           class="md-raised md-warn">
                    Yes, I confirm <i class="fa fa-exclamation-triangle"></i>
                </md-button>
            </li>
        </ul>

        <md-button class="md-raised" ng-hide="displayFormParameter"
                   ng-click="displayFormParameter=!displayFormParameter">
            <i class="fa fa-plus-square"></i>
        </md-button>

        <form ng-show="displayFormParameter" name="parameterForm" id="parameterForm" novalidate
              autocomplete="off" layout="row">
            <md-text-float label="Name" ng-model="parameter.name" type="text" ng-required="true"></md-text-float>
            <md-text-float label="Default Value" ng-model="parameter.value" type="text"
                           ng-required="true"></md-text-float>
            <md-text-float label="Description" ng-model="parameter.description" type="text"></md-text-float>

            <md-button ng-disabled="parameterForm.$invalid" class="md-raised md-primary"
                       data-ng-click="addParameter(); displayFormParameter=false">
                Insert Parameter
            </md-button>
        </form>
    </div>

    <div class="row">
        <h3>Ports</h3>
        <ul data-ng-repeat="port in daemon.ports">
            <li>-p &lg;externalPort-attributed-on-group&gt;:{{port.internal}}/{{port.protocol}}
                <small><i>{{port.description}}</i></small>
                <a ng-click="askDeletePort=true" ng-hide="askDeletePort">
                    <i class="fa fa-lg fa-trash-o cursor-pointer" tooltip="Delete Port"
                       tooltip-popup-delay='750'></i>
                </a>
                <md-button ng-click="askDeletePort=false" ng-show="askDeletePort" class="md-raised md-warn">
                    No, I don't want to delete this. <i class="fa fa-reply"></i>
                </md-button>
                <md-button data-ng-click="removePort(port);" ng-show="askDeletePort"
                           class="md-raised md-warn">
                    Yes, I confirm <i class="fa fa-exclamation-triangle"></i>
                </md-button>
            </li>
        </ul>

        <md-button class="md-raised" ng-hide="displayFormPort"
                   ng-click="displayFormPort=!displayFormPort">
            <i class="fa fa-plus-square"></i>
        </md-button>

        <form ng-show="displayFormPort" name="portForm" id="portForm" novalidate autocomplete="off" layout="row">
            <md-text-float label="Internal Port" ng-model="port.internal" type="number"
                           ng-required="true">
            </md-text-float>

            <md-radio-group ng-model="port.protocol" ng-required="true">
                <md-radio-button value="tcp">tcp</md-radio-button>
                <md-radio-button value="udp">udp</md-radio-button>
            </md-radio-group>

            <md-text-float label="Description" ng-model="port.description" type="text"></md-text-float>

            <md-button ng-disabled="portForm.$invalid"
                       data-ng-click="addPort(); displayFormPort=false" class="md-raised md-primary">
                Insert Port
            </md-button>
        </form>
    </div>

    <div class="row">
        <h3>Variables</h3>
        <ul data-ng-repeat="variable in daemon.variables">
            <li>
                <span ng-show="variable.value">-e {{variable.name}}:{{variable.value}}</span>
                <span ng-hide="variable.value">-e {{variable.name}}:&lg;nameVariable-attributed-on-group&gt;</span>

                <small><i>{{variable.description}}</i></small>
                <a ng-click="askDeleteVariable=true" ng-hide="askDeleteVariable">
                    <i class="fa fa-lg fa-trash-o cursor-pointer" tooltip="Delete Variable"
                       tooltip-popup-delay='750'></i>
                </a>
                <md-button ng-click="askDeleteVariable=false" ng-show="askDeleteVariable"
                           class="md-raised md-warn">
                    No, I don't want to delete this. <i class="fa fa-reply"></i>
                </md-button>
                <md-button data-ng-click="removeVariable(variable);" ng-show="askDeleteVariable"
                           class="md-raised md-warn">
                    Yes, I confirm <i class="fa fa-exclamation-triangle"></i>
                </md-button>
            </li>
        </ul>

        <md-button class="md-raised" ng-hide="displayFormVariable"
                   ng-click="displayFormVariable=!displayFormVariable">
            <i class="fa fa-plus-square"></i>
        </md-button>

        <form ng-show="displayFormVariable" name="variableForm" id="variableForm" novalidate
              autocomplete="off" layout="row">
            <md-text-float label="Name" ng-model="variable.name" type="text" ng-required="true"></md-text-float>
            <md-text-float label="Default Value" ng-model="variable.value" type="text"></md-text-float>
            <md-text-float label="Description" ng-model="variable.description" type="text"></md-text-float>

            <md-button ng-disabled="variableForm.$invalid"
                       data-ng-click="addVariable(); displayFormVariable=false"
                       class="md-raised md-primary">
                Insert Variable
            </md-button>
        </form>
    </div>

    <div class="row">
        <h3>Volume</h3>
        <ul data-ng-repeat="volume in daemon.volumes">
            <li>
                <span ng-show="volume.value">-v {{volume.value}}:{{volume.internal}}:{{volume.rights}}</span>
                <span ng-hide="volume.value">-v &lg;nameVolume-attributed-on-group&gt;:{{volume.internal}}:{{volume.rights}}</span>

                <small><i>{{volume.description}}</i></small>
                <a ng-click="askDeleteVolume=true" ng-hide="askDeleteVolume">
                    <i class="fa fa-lg fa-trash-o cursor-pointer" tooltip="Delete Volume"
                       tooltip-popup-delay='750'></i>
                </a>
                <md-button ng-click="askDeleteVolume=false" ng-show="askDeleteVolume"
                           class="md-raised md-warn">
                    No, I don't want to delete this. <i class="fa fa-reply"></i>
                </md-button>
                <md-button data-ng-click="removeVolume(volume);" ng-show="askDeleteVolume"
                           class="md-raised md-warn">
                    Yes, I confirm <i class="fa fa-exclamation-triangle"></i>
                </md-button>
            </li>
        </ul>

        <md-button class="md-raised" ng-hide="displayFormVolume"
                   ng-click="displayFormVolume=!displayFormVolume">
            <i class="fa fa-plus-square"></i>
        </md-button>

        <form ng-show="displayFormVolume" name="volumeForm" id="volumeForm" novalidate
              autocomplete="off" layout="row">

            <md-text-float label="Internal Volume" ng-model="volume.internal" type="text"
                           ng-required="true"></md-text-float>
            <md-text-float label="Default Value" ng-model="volume.value" type="text"></md-text-float>
            <md-radio-group ng-model="volume.rights" ng-required="true" ng-required="true">
                <md-radio-button value="rw">Read-Write</md-radio-button>
                <md-radio-button value="ro">Read Only</md-radio-button>
            </md-radio-group>
            <md-text-float label="Description" ng-model="volume.description" type="text"></md-text-float>

            <md-button ng-disabled="volumeForm.$invalid"
                       data-ng-click="addVolume(); displayFormVolume=false"
                       class="md-raised md-primary">
                Insert Volume
            </md-button>
            </fieldset>
        </form>
    </div>
    <br>

    <div class="row">
        <md-button ng-click="submitForm(daemonForm.$valid)" class="md-raised md-primary">
            <span ng-hide="daemon._id"><i class="fa fa-save"></i> Create Daemon</span>
            <span ng-show="daemon._id"><i class="fa fa-save"></i> Update Daemon</span>
        </md-button>
    </div>

    <md-subheader class="row md-warn" ng-show="error">
        <strong data-ng-bind="error"></strong>
    </md-subheader>
    <br>

    <div class="row">
        <md-button class="md-raised md-warn" ng-click="askDeleteDaemon=true" ng-hide="askDeleteDaemon">
            <i class="fa fa-trash-o" tooltip="Delete Daemon"
               tooltip-popup-delay='750'> </i> Delete Deamon
        </md-button>
        <md-button ng-click="askDeleteDaemon=false" ng-show="askDeleteDaemon" class="md-raised md-warn">
            No, I don't want to delete this. <i class="fa fa-reply"></i>
        </md-button>
        <md-button data-ng-click="remove(daemon);" ng-show="askDeleteDaemon"
                   class="md-raised md-warn">
            Yes, I confirm <i class="fa fa-exclamation-triangle"></i>
        </md-button>
    </div>
</section>
